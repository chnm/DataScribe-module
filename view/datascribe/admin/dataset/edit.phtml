<?php
$this->headScript()->appendFile($this->assetUrl('js/admin/dataset-form.js', 'Datascribe'));
$this->ckEditor();
$this->htmlElement('body')->appendAttribute('class', 'datascribe dataset edit');
$form->prepare();
?>

<?php echo $this->pageTitle($dataset->name(), 1, $this->translate('DataScribe: Dataset'), $this->translate('Edit')); ?>

<?php echo $this->form()->openTag($form); ?>

<div id="page-actions">
    <?php if ($dataset->isPublic()): ?>
    <?php echo $this->hyperlink('', '#', [
        'class' => 'o-icon-public button',
        'title' => $this->translate('Make private'),
    ]); ?>
    <input type="hidden" name="o:is_public" value="1">
    <?php else: ?>
    <?php echo $this->hyperlink('', '#', [
        'class' => 'o-icon-private button',
        'title' => $this->translate('Make public'),
    ]); ?>
    <input type="hidden" name="o:is_public" value="0">
    <?php endif; ?>
    <?php echo $this->cancelButton(); ?>
    <a href="#" class="delete button"><?php echo $this->translate('Delete'); ?></a>
    <button><?php echo $this->translate('Save'); ?></button>
</div>

<?php echo $this->sectionNav([
    'general' => $this->translate('General'),
    'form-builder' => $this->translate('Form Builder'),
]); ?>

<div id="general" class="active section">
    <?php echo $this->formCollection($form); ?>
</div>

<div id="form-builder" class="section">
    <div id="form-builder-fields"
        data-field-position-decrement="<?php echo $this->escapeHtml(sprintf('<button type="button" class="field-position-decrement">%s</button>', $this->translate('Move up'))); ?>"
        data-field-position-increment="<?php echo $this->escapeHtml(sprintf('<button type="button" class="field-position-increment">%s</button>', $this->translate('Move down'))); ?>"
        data-field-disable="<?php echo $this->escapeHtml(sprintf('<button type="button" class="field-disable">%s</button>', $this->translate('Delete'))); ?>"
        data-field-enable="<?php echo $this->escapeHtml(sprintf('<button type="button" class="field-enable">%s</button>', $this->translate('Undo delete'))); ?>">
        <?php echo $this->datascribe()->fields($dataset); ?>
    </div>
    <div id="data-types" class="sidebar always-open">
        <h3><?php echo $this->translate('Add a field to the form'); ?></h3>
        <?php foreach ($this->datascribe()->dataTypes() as $dataTypeName => $dataType): ?>
        <button class="option" data-name="<?php echo $this->escapeHtml($dataTypeName); ?>"><?php echo $this->escapeHtml($dataType->getLabel()); ?></button>
        <?php endforeach; ?>
    </div>
</div>

<?php echo $this->form()->closeTag(); ?>

<?php echo $this->deleteConfirm($dataset, 'dataset'); ?>

<?php echo $this->datascribe()->dataTypeTemplates();?>
